---
title: "CVE-2025-25294: Log Injection Vulnerability in Envoy Gateway"
date: 2025-03-20T20:00:00+01:00
draft: false
tags: [ "Security", "CVE"]
author: ["Dennis Kniep"]
comment: true
---

## Summary
I discovered a vulnerability in Envoy Gateway, which allowed attackers to manipulate access logs via malicious User-Agent string. By injecting payloads into the User-Agent Header, attackers could overwrite log fields (e.g., spoof IP addresses) or crash observability tools by corrupting log formats. After discovering this [CVE-2025-25294](https://github.com/envoyproxy/gateway/security/advisories/GHSA-mf24-chxh-hmvj), I responsibly disclosed it to the maintainers and also fixed the code via that [Commit](https://github.com/envoyproxy/gateway/commit/358bed50dcb7b32f39a2edb252fb1399c7fc65dc#diff-54ee3b0aaf1d655726b76fa0dd4749b64a32d4e6100e96c9d0a57aeb3ac19a75).

## Impact
In all Envoy Gateway versions prior to 1.2.7 and 1.3.1 a default Envoy Proxy access log configuration is used. This format is vulnerable to log injection attacks.

If the attacker uses a specially crafted user-agent which performs json injection, then he could add and overwrite fields to the access log.

Examples of attacks include:

Using following string as user agent : `HELLO-WORLD", "evil-ip": "1.1.1.1", "x-forwarded-for": "1.1.1.1` would lead to setting of new access log properties and overwrite of existing properties. Existing properties such as the value of the X-Forwarded-For header may have importance for security analysis of access logs, and their overwrite can be used to hide malicious activity.

Using the following string as user-agent : `"` which renders an invalid json document. The invalid document may fail to be processed by observability solutions, which would allow attacker to hide malicious activity.

## Fix
Using JSON format as the default format for access logs. The logged document will contain the same key and values as before. Only the order of properties is different inside the logged document.